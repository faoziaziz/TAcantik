<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class=" js flexbox canvas canvastext webgl no-touch geolocation postmessage no-websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients no-cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths" style="" lang="en"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Starting with GHDL — GHDL 2017-03-01 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  

  
    <link rel="stylesheet" href="Starting%20with%20GHDL%20%E2%80%94%20GHDL%202017-03-01%20documentation_files/sphinx_rtd_theme.css" type="text/css">
  

  
        <link rel="index" title="Index" href="http://ghdl.readthedocs.io/en/latest/genindex.html">
        <link rel="search" title="Search" href="http://ghdl.readthedocs.io/en/latest/search.html">
    <link rel="top" title="GHDL 2017-03-01 documentation" href="http://ghdl.readthedocs.io/en/latest/index.html">
        <link rel="next" title="Invoking GHDL" href="http://ghdl.readthedocs.io/en/latest/Invoking_GHDL.html">
        <link rel="prev" title="Introduction" href="http://ghdl.readthedocs.io/en/latest/Introduction.html"> 

  
  <script type="text/javascript" async="" src="Starting%20with%20GHDL%20%E2%80%94%20GHDL%202017-03-01%20documentation_files/ga.js"></script><script src="Starting%20with%20GHDL%20%E2%80%94%20GHDL%202017-03-01%20documentation_files/modernizr.js"></script>


<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="http://ghdl.readthedocs.io/en/latest/Starting_with_GHDL.html">

<link rel="stylesheet" href="Starting%20with%20GHDL%20%E2%80%94%20GHDL%202017-03-01%20documentation_files/readthedocs-doc-embed.css" type="text/css">

<script type="text/javascript" src="Starting%20with%20GHDL%20%E2%80%94%20GHDL%202017-03-01%20documentation_files/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = 'Starting_with_GHDL' 		
READTHEDOCS_DATA['source_suffix'] = '.rst'
</script>

<script type="text/javascript" src="Starting%20with%20GHDL%20%E2%80%94%20GHDL%202017-03-01%20documentation_files/readthedocs-dynamic-include.js"></script>

<!-- end RTD <extrahead> --></head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="http://ghdl.readthedocs.io/en/latest/index.html" class="icon icon-home"> GHDL
          

          
          </a>

          
            
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input name="q" placeholder="Search docs" type="text">
    <input name="check_keywords" value="yes" type="hidden">
    <input name="area" value="default" type="hidden">
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="http://ghdl.readthedocs.io/en/latest/Introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><span class="toctree-expand"></span>Starting with GHDL</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-hello-world-program">The hello world program</a></li>
<li class="toctree-l2"><a class="reference internal" href="#a-full-adder">A full adder</a></li>
<li class="toctree-l2"><a class="reference internal" href="#starting-with-a-design">Starting with a design</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="http://ghdl.readthedocs.io/en/latest/Invoking_GHDL.html">Invoking GHDL</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://ghdl.readthedocs.io/en/latest/Simulation_and_runtime.html">Simulation and runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://ghdl.readthedocs.io/en/latest/GHDL_implementation_of_VHDL.html">GHDL implementation of VHDL</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://ghdl.readthedocs.io/en/latest/GHDL_implementation_of_VITAL.html">GHDL implementation of VITAL</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://ghdl.readthedocs.io/en/latest/Flaws_and_bugs_report.html">Flaws and bugs report</a></li>
<li class="toctree-l1"><a class="reference internal" href="http://ghdl.readthedocs.io/en/latest/Copyrights.html">Copyrights</a></li>
</ul>

            
          
        </div>
      <div class="rtd-pro wy-menu"><div class="rtd-pro-about"><a href="https://readthedocs.org/sustainability/advertising/"><i class="fa fa-info-circle"></i></a></div><a class="rtd-pro-image-wrapper" href="http://readthedocs.org/sustainability/click/146/Q962Nc4B88BD/" target="_blank"><img class="rtd-pro-image" src="Starting%20with%20GHDL%20%E2%80%94%20GHDL%202017-03-01%20documentation_files/a.png"></a><span>Reach 7 million devs each month when you <a class="rtd-pro-link" href="http://readthedocs.org/sustainability/click/146/Q962Nc4B88BD/" target="_blank">advertise with Read the Docs</a>.</span></div><div class="rtd-pro-wrapper"></div></div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="http://ghdl.readthedocs.io/en/latest/index.html">GHDL</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="http://ghdl.readthedocs.io/en/latest/index.html">Docs</a> »</li>
        
      <li>Starting with GHDL</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/tgingold/ghdl/blob/master/doc/Starting_with_GHDL.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="starting-with-ghdl">
<h1>Starting with GHDL<a class="headerlink" href="#starting-with-ghdl" title="Permalink to this headline">¶</a></h1>
<p>In this chapter, you will learn how to use the GHDL compiler by
working on two examples.</p>
<div class="section" id="the-hello-world-program">
<h2>The hello world program<a class="headerlink" href="#the-hello-world-program" title="Permalink to this headline">¶</a></h2>
<p>To illustrate the large purpose of VHDL, here is a commented VHDL
“Hello world” program.</p>
<div class="highlight-VHDL"><div class="highlight"><pre><span></span><span class="c1">--  Hello world program.</span>
<span class="k">use</span> <span class="nn">std.textio.</span><span class="k">all</span><span class="p">;</span> <span class="c1">-- Imports the standard textio package.</span>

<span class="c1">--  Defines a design entity, without any ports.</span>
<span class="k">entity</span> <span class="nc">hello_world</span> <span class="k">is</span>
<span class="k">end</span> <span class="nc">hello_world</span><span class="p">;</span>

<span class="k">architecture</span> <span class="nc">behaviour</span> <span class="k">of</span> <span class="nc">hello_world</span> <span class="k">is</span>
<span class="k">begin</span>
   <span class="k">process</span>
      <span class="k">variable</span> <span class="n">l</span> <span class="o">:</span> <span class="n">line</span><span class="p">;</span>
   <span class="k">begin</span>
      <span class="n">write</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="kt">String</span><span class="p">'(</span><span class="s">"Hello world!"</span><span class="p">));</span>
      <span class="n">writeline</span> <span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">l</span><span class="p">);</span>
      <span class="k">wait</span><span class="p">;</span>
   <span class="k">end</span> <span class="k">process</span><span class="p">;</span>
<span class="k">end</span> <span class="nc">behaviour</span><span class="p">;</span>
</pre></div>
</div>
<p>Suppose this program is contained in the file <code class="file docutils literal"><span class="pre">hello.vhdl</span></code>.
First, you have to compile the file; this is called <cite>analysis</cite> of a design
file in VHDL terms.</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ghdl -a hello.vhdl
</pre></div>
</div>
<p>This command creates or updates a file <code class="file docutils literal"><span class="pre">work-obj93.cf</span></code>, which
describes the library <cite>work</cite>.  On GNU/Linux, this command generates a
file <code class="file docutils literal"><span class="pre">hello.o</span></code>, which is the object file corresponding to your
VHDL program.  The object file is not created on Windows.</p>
<p>Then, you have to build an executable file.</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ghdl -e hello_world
</pre></div>
</div>
<p>The <code class="xref std std-option docutils literal"><span class="pre">-e</span></code> option means <em class="dfn">elaborate</em>.  With this option, <cite>GHDL</cite>
creates code in order to elaborate a design, with the <code class="samp docutils literal"><span class="pre">hello_world</span></code>
entity at the top of the hierarchy.</p>
<p>On GNU/Linux, if you have enabled the GCC backend during the compilation of <cite>GHDL</cite>,
an executable program called <code class="file docutils literal"><span class="pre">hello_world</span></code> which can be run is generated:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ghdl -r hello_world
</pre></div>
</div>
<p>or directly:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ./hello_world
</pre></div>
</div>
<p>On Windows or if the GCC backend was not enabled, no file is created.
The simulation is launched using this command:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>&gt; ghdl -r hello_world
</pre></div>
</div>
<p>The result of the simulation appears on the screen:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Hello world!
</pre></div>
</div>
</div>
<div class="section" id="a-full-adder">
<h2>A full adder<a class="headerlink" href="#a-full-adder" title="Permalink to this headline">¶</a></h2>
<p>VHDL is generally used for hardware design.  This example starts with
a full adder described in the <code class="file docutils literal"><span class="pre">adder.vhdl</span></code> file:</p>
<div class="highlight-VHDL"><div class="highlight"><pre><span></span><span class="k">entity</span> <span class="nc">adder</span> <span class="k">is</span>
  <span class="c1">-- `i0`, `i1` and the carry-in `ci` are inputs of the adder.</span>
  <span class="c1">-- `s` is the sum output, `co` is the carry-out.</span>
  <span class="k">port</span> <span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span> <span class="o">:</span> <span class="k">in</span> <span class="kt">bit</span><span class="p">;</span> <span class="n">ci</span> <span class="o">:</span> <span class="k">in</span> <span class="kt">bit</span><span class="p">;</span> <span class="n">s</span> <span class="o">:</span> <span class="k">out</span> <span class="kt">bit</span><span class="p">;</span> <span class="n">co</span> <span class="o">:</span> <span class="k">out</span> <span class="kt">bit</span><span class="p">);</span>
<span class="k">end</span> <span class="nc">adder</span><span class="p">;</span>

<span class="k">architecture</span> <span class="nc">rtl</span> <span class="k">of</span> <span class="nc">adder</span> <span class="k">is</span>
<span class="k">begin</span>
   <span class="c1">--  This full-adder architecture contains two concurrent assignment.</span>
   <span class="c1">--  Compute the sum.</span>
   <span class="n">s</span> <span class="o">&lt;=</span> <span class="n">i0</span> <span class="k">xor</span> <span class="n">i1</span> <span class="k">xor</span> <span class="n">ci</span><span class="p">;</span>
   <span class="c1">--  Compute the carry.</span>
   <span class="n">co</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">i0</span> <span class="k">and</span> <span class="n">i1</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="n">i0</span> <span class="k">and</span> <span class="n">ci</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="n">i1</span> <span class="k">and</span> <span class="n">ci</span><span class="p">);</span>
<span class="k">end</span> <span class="nc">rtl</span><span class="p">;</span>
</pre></div>
</div>
<p>You can analyze this design file:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ghdl -a adder.vhdl
</pre></div>
</div>
<p>You can try to execute the <cite>adder</cite> design, but this is useless,
since nothing externally visible will happen.  In order to
check this full adder, a testbench has to be run.  This testbench is
very simple, since the adder is also simple: it checks exhaustively all
inputs.  Note that only the behaviour is tested, timing constraints are
not checked.  The file <code class="file docutils literal"><span class="pre">adder_tb.vhdl</span></code> contains the testbench for
the adder:</p>
<div class="highlight-VHDL"><div class="highlight"><pre><span></span><span class="c1">--  A testbench has no ports.</span>
<span class="k">entity</span> <span class="nc">adder_tb</span> <span class="k">is</span>
<span class="k">end</span> <span class="nc">adder_tb</span><span class="p">;</span>

<span class="k">architecture</span> <span class="nc">behav</span> <span class="k">of</span> <span class="nc">adder_tb</span> <span class="k">is</span>
   <span class="c1">--  Declaration of the component that will be instantiated.</span>
   <span class="k">component</span> <span class="nc">adder</span>
     <span class="k">port</span> <span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span> <span class="o">:</span> <span class="k">in</span> <span class="kt">bit</span><span class="p">;</span> <span class="n">ci</span> <span class="o">:</span> <span class="k">in</span> <span class="kt">bit</span><span class="p">;</span> <span class="n">s</span> <span class="o">:</span> <span class="k">out</span> <span class="kt">bit</span><span class="p">;</span> <span class="n">co</span> <span class="o">:</span> <span class="k">out</span> <span class="kt">bit</span><span class="p">);</span>
   <span class="k">end</span> <span class="k">component</span><span class="p">;</span>

   <span class="c1">--  Specifies which entity is bound with the component.</span>
   <span class="k">for</span> <span class="n">adder_0</span><span class="o">:</span> <span class="n">adder</span> <span class="k">use</span> <span class="k">entity</span> <span class="nn">work</span><span class="p">.</span><span class="n">adder</span><span class="p">;</span>
   <span class="k">signal</span> <span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">ci</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">co</span> <span class="o">:</span> <span class="kt">bit</span><span class="p">;</span>
<span class="k">begin</span>
   <span class="c1">--  Component instantiation.</span>
   <span class="n">adder_0</span><span class="o">:</span> <span class="n">adder</span> <span class="k">port</span> <span class="k">map</span> <span class="p">(</span><span class="n">i0</span> <span class="o">=&gt;</span> <span class="n">i0</span><span class="p">,</span> <span class="n">i1</span> <span class="o">=&gt;</span> <span class="n">i1</span><span class="p">,</span> <span class="n">ci</span> <span class="o">=&gt;</span> <span class="n">ci</span><span class="p">,</span>
                            <span class="n">s</span> <span class="o">=&gt;</span> <span class="n">s</span><span class="p">,</span> <span class="n">co</span> <span class="o">=&gt;</span> <span class="n">co</span><span class="p">);</span>

   <span class="c1">--  This process does the real job.</span>
   <span class="k">process</span>
      <span class="k">type</span> <span class="n">pattern_type</span> <span class="k">is</span> <span class="k">record</span>
         <span class="c1">--  The inputs of the adder.</span>
         <span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">ci</span> <span class="o">:</span> <span class="kt">bit</span><span class="p">;</span>
         <span class="c1">--  The expected outputs of the adder.</span>
         <span class="n">s</span><span class="p">,</span> <span class="n">co</span> <span class="o">:</span> <span class="kt">bit</span><span class="p">;</span>
      <span class="k">end</span> <span class="k">record</span><span class="p">;</span>
      <span class="c1">--  The patterns to apply.</span>
      <span class="k">type</span> <span class="n">pattern_array</span> <span class="k">is</span> <span class="k">array</span> <span class="p">(</span><span class="kt">natural</span> <span class="k">range</span> <span class="o">&lt;&gt;</span><span class="p">)</span> <span class="k">of</span> <span class="n">pattern_type</span><span class="p">;</span>
      <span class="k">constant</span> <span class="n">patterns</span> <span class="o">:</span> <span class="n">pattern_array</span> <span class="o">:=</span>
        <span class="p">((</span><span class="sc">'0'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">),</span>
         <span class="p">(</span><span class="sc">'0'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">),</span>
         <span class="p">(</span><span class="sc">'0'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">),</span>
         <span class="p">(</span><span class="sc">'0'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">),</span>
         <span class="p">(</span><span class="sc">'1'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">),</span>
         <span class="p">(</span><span class="sc">'1'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">),</span>
         <span class="p">(</span><span class="sc">'1'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">,</span> <span class="sc">'0'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">),</span>
         <span class="p">(</span><span class="sc">'1'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">,</span> <span class="sc">'1'</span><span class="p">));</span>
   <span class="k">begin</span>
      <span class="c1">--  Check each pattern.</span>
      <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="n">patterns</span><span class="na">'range</span> <span class="k">loop</span>
         <span class="c1">--  Set the inputs.</span>
         <span class="n">i0</span> <span class="o">&lt;=</span> <span class="n">patterns</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">i0</span><span class="p">;</span>
         <span class="n">i1</span> <span class="o">&lt;=</span> <span class="n">patterns</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">i1</span><span class="p">;</span>
         <span class="n">ci</span> <span class="o">&lt;=</span> <span class="n">patterns</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">ci</span><span class="p">;</span>
         <span class="c1">--  Wait for the results.</span>
         <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>
         <span class="c1">--  Check the outputs.</span>
         <span class="k">assert</span> <span class="n">s</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">s</span>
            <span class="n">report</span> <span class="s">"bad sum value"</span> <span class="k">severity</span> <span class="n">error</span><span class="p">;</span>
         <span class="k">assert</span> <span class="n">co</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">co</span>
            <span class="n">report</span> <span class="s">"bad carry out value"</span> <span class="k">severity</span> <span class="n">error</span><span class="p">;</span>
      <span class="k">end</span> <span class="k">loop</span><span class="p">;</span>
      <span class="k">assert</span> <span class="n">false</span> <span class="n">report</span> <span class="s">"end of test"</span> <span class="k">severity</span> <span class="n">note</span><span class="p">;</span>
      <span class="c1">--  Wait forever; this will finish the simulation.</span>
      <span class="k">wait</span><span class="p">;</span>
   <span class="k">end</span> <span class="k">process</span><span class="p">;</span>
<span class="k">end</span> <span class="nc">behav</span><span class="p">;</span>
</pre></div>
</div>
<p>As usual, you should analyze the design:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ghdl -a adder_tb.vhdl
</pre></div>
</div>
<p>And build an executable for the testbench:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ghdl -e adder_tb
</pre></div>
</div>
<p>You do not need to specify which object files are required: GHDL knows them
and automatically adds them in the executable.  Now, it is time to run the
testbench:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ghdl -r adder_tb
adder_tb.vhdl:52:7:<span class="o">(</span>assertion note<span class="o">)</span>: end of <span class="nb">test</span>
</pre></div>
</div>
<p>If your design is rather complex, you’d like to inspect signals.  Signals
value can be dumped using the VCD file format.  The resulting file can be
read with a wave viewer such as GTKWave.  First, you should simulate your
design and dump a waveform file:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ghdl -r adder_tb --vcd<span class="o">=</span>adder.vcd
</pre></div>
</div>
<p>Then, you may now view the waves:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ gtkwave adder.vcd
</pre></div>
</div>
<p>See <a class="reference internal" href="http://ghdl.readthedocs.io/en/latest/Simulation_and_runtime.html#simulation-options"><span class="std std-ref">Simulation options</span></a>, for more details on the <a class="reference internal" href="http://ghdl.readthedocs.io/en/latest/Simulation_and_runtime.html#cmdoption-vcd"><code class="xref std std-option docutils literal"><span class="pre">--vcd</span></code></a> option and
other runtime options.</p>
</div>
<div class="section" id="starting-with-a-design">
<h2>Starting with a design<a class="headerlink" href="#starting-with-a-design" title="Permalink to this headline">¶</a></h2>
<p>Unless you are only studying VHDL, you will work with bigger designs than
the ones of the previous examples.</p>
<p>Let’s see how to analyze and run a bigger design, such as the DLX model
suite written by Peter Ashenden which is distributed under the terms of the
GNU General Public License.  A copy is kept on
<a class="reference external" href="http://ghdl.free.fr/dlx.tar.gz">http://ghdl.free.fr/dlx.tar.gz</a></p>
<p>First, untar the sources:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ tar zxvf dlx.tar.gz
</pre></div>
</div>
<p>In order not to pollute the sources with the library, it is a good idea
to create a <code class="file docutils literal"><span class="pre">work/</span></code> subdirectory for the <cite>WORK</cite> library.  To
any GHDL commands, we will add the <code class="xref std std-option docutils literal"><span class="pre">--workdir=work</span></code> option, so
that all files generated by the compiler (except the executable) will be
placed in this directory.</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> dlx
$ mkdir work
</pre></div>
</div>
<p>We will run the <code class="samp docutils literal"><span class="pre">dlx_test_behaviour</span></code> design.  We need to analyze
all the design units for the design hierarchy, in the correct order.
GHDL provides an easy way to do this, by importing the sources:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ghdl -i --workdir<span class="o">=</span>work *.vhdl
</pre></div>
</div>
<p>and making a design:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ghdl -m --workdir<span class="o">=</span>work dlx_test_behaviour
</pre></div>
</div>
<p>Before this second stage, GHDL knows all the design units of the DLX,
but no one have been analyzed.  The make command of GHDL analyzes and
elaborates a design.  This creates many files in the <code class="file docutils literal"><span class="pre">work/</span></code>
directory, and the <code class="file docutils literal"><span class="pre">dlx_test_behaviour</span></code> executable in the current
directory.</p>
<p>The simulation needs to have a DLX program contained in the file
<code class="file docutils literal"><span class="pre">dlx.out</span></code>.  This memory image will be be loaded in the DLX memory.
Just take one sample:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ cp test_loop.out dlx.out
</pre></div>
</div>
<p>And you can run the test suite:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ghdl -r --workdir<span class="o">=</span>work dlx_test_behaviour
</pre></div>
</div>
<p>The test bench monitors the bus and displays each instruction executed.
It finishes with an assertion of severity level note:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>dlx-behaviour.vhdl:395:11:<span class="o">(</span>assertion note<span class="o">)</span>: TRAP instruction
 encountered, execution halted
</pre></div>
</div>
<p>Since the clock is still running, you have to manually stop the program
with the <code class="kbd docutils literal"><span class="pre">C-c</span></code> key sequence.  This behavior prevents you from running the
test bench in batch mode.  However, you may force the simulator to
stop when an assertion above or equal a certain severity level occurs:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ghdl -r --workdir<span class="o">=</span>work dlx_test_behaviour --assert-level<span class="o">=</span>note
</pre></div>
</div>
<p>With this option, the program stops just after the previous message:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dlx</span><span class="o">-</span><span class="n">behaviour</span><span class="o">.</span><span class="n">vhdl</span><span class="p">:</span><span class="mi">395</span><span class="p">:</span><span class="mi">11</span><span class="p">:(</span><span class="n">assertion</span> <span class="n">note</span><span class="p">):</span> <span class="n">TRAP</span> <span class="n">instruction</span>
 <span class="n">encountered</span><span class="p">,</span> <span class="n">execution</span> <span class="n">halted</span>
<span class="n">error</span><span class="p">:</span> <span class="n">assertion</span> <span class="n">failed</span>
</pre></div>
</div>
<p>If you want to make room on your hard drive, you can either:</p>
<ul>
<li><p class="first">clean the design library with the GHDL command:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ghdl --clean --workdir<span class="o">=</span>work
</pre></div>
</div>
<p>This removes the executable and all the object files.  If you want to
rebuild the design at this point, just do the make command as shown
above.</p>
</li>
<li><p class="first">remove the design library with the GHDL command:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ ghdl --remove --workdir<span class="o">=</span>work
</pre></div>
</div>
<p>This removes the executable, all the object files and the library file.
If you want to rebuild the design, you have to import the sources again,
and to make the design.</p>
</li>
<li><p class="first">remove the <code class="file docutils literal"><span class="pre">work/</span></code> directory:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ rm -rf work
</pre></div>
</div>
<p>Only the executable is kept.  If you want to rebuild the design, create
the <code class="file docutils literal"><span class="pre">work/</span></code> directory, import the sources, and make the design.</p>
</li>
</ul>
<p>Sometimes, a design does not fully follow the VHDL standards.  For example it
uses the badly engineered <code class="samp docutils literal"><span class="pre">std_logic_unsigned</span></code> package.  GHDL supports
this VHDL dialect through some options:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">ieee</span><span class="o">=</span><span class="n">synopsys</span> <span class="o">-</span><span class="n">fexplicit</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="http://ghdl.readthedocs.io/en/latest/Invoking_GHDL.html#ieee-library-pitfalls"><span class="std std-ref">IEEE library pitfalls</span></a>, for more details.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="http://ghdl.readthedocs.io/en/latest/Invoking_GHDL.html" class="btn btn-neutral float-right" title="Invoking GHDL" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="http://ghdl.readthedocs.io/en/latest/Introduction.html" class="btn btn-neutral" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr>

  <div role="contentinfo">
    <p>
        © Copyright 2015, Tristan Gingold.
      
        <span class="commit">
          Revision <code>9a90393e</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org/">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions"><!-- Inserted RTD Footer -->
<div class="injected">

  

      
      
      
      <dl>
        <dt>Versions</dt>
        
         <strong> 
        <dd><a href="http://ghdl.readthedocs.io/en/latest/Starting_with_GHDL.html">latest</a></dd>
         </strong> 
        
        
        <dd><a href="http://ghdl.readthedocs.io/en/stable/Starting_with_GHDL.html">stable</a></dd>
        
        
        
        <dd><a href="http://ghdl.readthedocs.io/en/new-documentation-structure/Starting_with_GHDL.html">new-documentation-structure</a></dd>
        
        
      </dl>
      
      

      
      
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="http://readthedocs.org/projects/ghdl/downloads/pdf/latest/">PDF</a></dd>
        
        <dd><a href="http://readthedocs.org/projects/ghdl/downloads/htmlzip/latest/">HTML</a></dd>
        
      </dl>
      
      

      
      <dl>
        <!-- These are kept as relative links for internal installs that are http -->
        <dt>On Read the Docs</dt>
        <dd>
          <a href="http://readthedocs.org/projects/ghdl/">Project Home</a>
        </dd>
        <dd>
          <a href="http://readthedocs.org/projects/ghdl/builds/">Builds</a>
        </dd>
        <dd>
          <a href="http://readthedocs.org/projects/ghdl/downloads/">Downloads</a>
        </dd>
      </dl>
      

      

      
      <dl>
        <dt>On GitHub</dt>
        <dd>
          <a href="https://github.com/tgingold/ghdl/blob/master/doc/Starting_with_GHDL.rst">View</a>
        </dd>
        <dd>
          <a href="https://github.com/tgingold/ghdl/edit/master/doc/Starting_with_GHDL.rst">Edit</a>
        </dd>
      </dl>
      
      

      
      <dl>
        <dt>Search</dt>
        <dd>
          <div style="padding: 6px;">
            <form id="flyout-search-form" class="wy-form" target="_blank" action="//readthedocs.org/projects/ghdl/search/" method="get">
              <input name="q" placeholder="Search docs" type="text">
              </form>
          </div>
        </dd>
      </dl>
      



      <hr>
      
      Free document hosting provided by <a href="https://readthedocs.org/">Read the Docs</a>. 
      

      

</div>
</div>
  </div>



  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2017-03-01',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="Starting%20with%20GHDL%20%E2%80%94%20GHDL%202017-03-01%20documentation_files/jquery-2.js"></script>
      <script type="text/javascript" src="Starting%20with%20GHDL%20%E2%80%94%20GHDL%202017-03-01%20documentation_files/jquery-migrate-1.js"></script>
      <script type="text/javascript" src="Starting%20with%20GHDL%20%E2%80%94%20GHDL%202017-03-01%20documentation_files/underscore.js"></script>
      <script type="text/javascript" src="Starting%20with%20GHDL%20%E2%80%94%20GHDL%202017-03-01%20documentation_files/doctools.js"></script>
      <script type="text/javascript" src="Starting%20with%20GHDL%20%E2%80%94%20GHDL%202017-03-01%20documentation_files/readthedocs-doc-embed.js"></script>

  

  
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   


</body></html>